<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Code Prompt Builder v1.1</title>
    <style>
        :root {
            /* Light Theme */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --border-hover: #cbd5e1;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --accent-hover: #2563eb;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border-color: #334155;
            --border-hover: #475569;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --accent-hover: #60a5fa;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .app-container {
            max-width: none;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 24px;
            align-items: start;
            position: relative;
            width: 100vw;
            box-sizing: border-box;
        }

        .resize-handle {
            position: absolute;
            top: 0;
            right: 420px;
            width: 4px;
            height: 100%;
            background: var(--border-color);
            cursor: col-resize;
            transition: background-color 0.3s ease;
            z-index: 10;
        }

        .resize-handle:hover {
            background: var(--accent-primary);
        }

        .resize-handle.dragging {
            background: var(--accent-primary);
        }

        .main-panel {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .output-panel {
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            padding: 24px;
            height: fit-content;
            position: sticky;
            top: 20px;
            transition: all 0.3s ease;
        }

        .header {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            color: white;
            padding: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: -0.025em;
        }

        .header-content p {
            opacity: 0.9;
            font-size: 14px;
            font-weight: 500;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-lg);
            padding: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .main-content {
            padding: 32px;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .form-section {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 24px;
            transition: all 0.3s ease;
        }

        .form-section:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-sm);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 14px;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            transform: translateY(-1px);
        }

        input:hover, select:hover, textarea:hover {
            border-color: var(--border-hover);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
            line-height: 1.5;
        }

        .mode-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .mode-option {
            position: relative;
        }

        .mode-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .mode-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            background: var(--bg-primary);
            position: relative;
            overflow: hidden;
        }

        .mode-label::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mode-label * {
            position: relative;
            z-index: 1;
        }

        .mode-option input[type="radio"]:checked + .mode-label {
            border-color: var(--accent-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .mode-option input[type="radio"]:checked + .mode-label::before {
            opacity: 1;
        }

        .mode-label:hover {
            border-color: var(--accent-primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .mode-label .mode-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .mode-label .mode-desc {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .output-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .prompt-output {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            min-height: 200px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
            white-space: pre-wrap;
            color: var(--text-primary);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            overflow-y: auto;
            resize: vertical;
            outline: none;
            word-wrap: break-word;
            width: 100%;
            box-sizing: border-box;
        }

        .prompt-output:hover {
            border-color: var(--border-hover);
        }

        .prompt-output:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .btn-success {
            background: var(--success);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        .agreement-toggle {
            margin-top: 20px;
            text-align: center;
        }

        .agreement-content {
            display: none;
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.4;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background: #48bb78;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            display: none;
            z-index: 1000;
        }

        /* Template System Styles */
        .templates-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .template-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .template-categories {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--bg-primary);
        }

        .template-category {
            border-bottom: 1px solid var(--border-color);
        }

        .template-category:last-child {
            border-bottom: none;
        }

        .category-header {
            padding: 16px 20px;
            background: var(--bg-tertiary);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--text-primary);
            transition: all 0.3s ease;
            border: none;
        }

        .category-header:hover {
            background: var(--border-hover);
            transform: translateY(-1px);
        }

        .category-content {
            padding: 20px;
            display: none;
            gap: 12px;
            flex-wrap: wrap;
            background: var(--bg-primary);
        }

        .category-content.open {
            display: flex;
        }

        .template-btn {
            padding: 10px 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            min-width: fit-content;
            position: relative;
            overflow: hidden;
        }

        .template-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
            transition: left 0.5s;
        }

        .template-btn:hover::before {
            left: 100%;
        }

        .template-btn:hover {
            border-color: var(--accent-primary);
            background: var(--bg-tertiary);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .template-btn.favorite {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .toggle-icon {
            transition: transform 0.3s ease;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .toggle-icon.rotated {
            transform: rotate(180deg);
        }

        #template-search {
            padding: 10px 16px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 14px;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        #template-search:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        .ai-env-btn {
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-primary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .ai-env-btn:hover {
            border-color: var(--accent-primary);
            background: var(--bg-tertiary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .ai-env-btn:active {
            transform: translateY(0);
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .mode-selector {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }

            .templates-header {
                flex-direction: column;
                gap: 10px;
            }

            .template-controls {
                flex-wrap: wrap;
                gap: 5px;
            }

            .category-content {
                flex-direction: column;
            }

            .app-container {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 16px;
            }

            .output-panel {
                position: static;
                order: -1;
            }

            .main-panel {
                order: 1;
            }

            .header {
                padding: 24px;
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }

            .main-content {
                padding: 24px;
                gap: 24px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .mode-selector {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .button-group {
                grid-template-columns: 1fr;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="resize-handle" id="resize-handle"></div>
        <div class="main-panel">
            <div class="header">
                <div class="header-content">
    <h1>🤖 AI Code Prompt Builder</h1>
                    <p>AI-Assisted Development Agreements v1.1 Compliant</p>
                </div>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <span id="theme-icon">🌙</span>
                </button>
            </div>

            <div class="main-content">
                <div class="form-section">
                    <div class="section-title">📋 Project Configuration</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="project-name">Project Name</label>
                            <input type="text" id="project-name" placeholder="e.g., PandorAICoder" value="PandorAICoder">
                        </div>
                        <div class="form-group">
                            <label for="project-version">Version</label>
                            <input type="text" id="project-version" placeholder="e.g., v2.3.2" value="v2.3.2">
                        </div>
                        <div class="form-group">
                            <label for="tech-stack">Technology Stack</label>
                            <input type="text" id="tech-stack" placeholder="e.g., Python backend, JavaScript frontend" value="Python backend, JavaScript frontend">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">⚙️ Development Mode</div>
                    <div class="mode-selector">
                        <div class="mode-option">
                            <input type="radio" id="mode-quick" name="mode" value="QUICK">
                            <label for="mode-quick" class="mode-label">
                                <div class="mode-title">⚡ QUICK</div>
                                <div class="mode-desc">Simple, safe changes</div>
                            </label>
                        </div>
                        <div class="mode-option">
                            <input type="radio" id="mode-normal" name="mode" value="NORMAL" checked>
                            <label for="mode-normal" class="mode-label">
                                <div class="mode-title">🔧 NORMAL</div>
                                <div class="mode-desc">Standard development</div>
                            </label>
                        </div>
                        <div class="mode-option">
                            <input type="radio" id="mode-secure" name="mode" value="SECURE">
                            <label for="mode-secure" class="mode-label">
                                <div class="mode-title">🔒 SECURE</div>
                                <div class="mode-desc">Complex, risky changes</div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">📝 Request Details</div>
                    <div class="form-group">
                        <label for="request-description">What do you need?</label>
                        <textarea id="request-description" placeholder="Describe what you want the AI to do..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="constraints">Constraints (Optional)</label>
                        <textarea id="constraints" placeholder="What should NOT be changed or any specific requirements..."></textarea>
                    </div>
                </div>

            <div class="form-section">
                <div class="templates-header">
                    <label>Smart Templates</label>
                    <div class="template-controls">
                        <input type="text" id="template-search" placeholder="🔍 Search templates..." style="width: 200px; margin-right: 10px;">
                        <button class="btn btn-sm btn-secondary" onclick="toggleFavorites()">⭐ Favorites</button>
                        <button class="btn btn-sm btn-primary" onclick="createCustomTemplate()">➕ New</button>
                    </div>
                </div>
                
                <div class="template-categories">
                    <!-- PROJECT LIFECYCLE -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('project')">
                            <span>📋 PROJECT LIFECYCLE</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="project-templates">
                            <button class="template-btn" onclick="loadTemplate('project-init')">🚀 Project Initiation</button>
                            <button class="template-btn" onclick="loadTemplate('project-continue')">🔄 Project Continuation</button>
                            <button class="template-btn" onclick="loadTemplate('project-status')">📊 Progress Check</button>
                            <button class="template-btn" onclick="loadTemplate('project-phase')">📋 Phase Wrap-up</button>
                            <button class="template-btn" onclick="loadTemplate('project-close')">🏁 Project Closure</button>
                            <button class="template-btn" onclick="loadTemplate('daily-start')">🌅 Daily Start</button>
                            <button class="template-btn" onclick="loadTemplate('daily-end')">🌙 Daily Wrap-up</button>
                        </div>
                    </div>

                    <!-- SESSION MANAGEMENT -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('session')">
                            <span>🔄 SESSION MANAGEMENT</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="session-templates">
                            <button class="template-btn" onclick="loadTemplate('session-start')">🚀 Session Start</button>
                            <button class="template-btn" onclick="loadTemplate('pre-compact')">📦 Pre-Compaction</button>
                            <button class="template-btn" onclick="loadTemplate('post-compact')">🔄 Post-Compaction</button>
                            <button class="template-btn" onclick="loadTemplate('context-recovery')">🔧 Context Recovery</button>
                            <button class="template-btn" onclick="loadTemplate('handoff')">👥 Team Handoff</button>
                        </div>
                    </div>

                    <!-- GIT & BACKUP -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('git')">
                            <span>🔀 GIT & BACKUP</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="git-templates">
                            <button class="template-btn" onclick="loadTemplate('git-init')">📦 Git Repository Setup</button>
                            <button class="template-btn" onclick="loadTemplate('git-sync')">🔄 Git Sync</button>
                            <button class="template-btn" onclick="loadTemplate('backup-create')">💾 Create Backup</button>
                            <button class="template-btn" onclick="loadTemplate('rollback')">↩️ Rollback Changes</button>
                            <button class="template-btn" onclick="loadTemplate('backup-restore')">🔄 Restore Backup</button>
                            <button class="template-btn" onclick="loadTemplate('git-recovery')">🚨 Git Recovery</button>
                        </div>
                    </div>

                    <!-- DEBUG & ANALYSIS -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('debug')">
                            <span>🐛 DEBUG & ANALYSIS</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="debug-templates">
                            <button class="template-btn" onclick="loadTemplate('frontend-debug')">🎨 Frontend Debug</button>
                            <button class="template-btn" onclick="loadTemplate('backend-debug')">⚙️ Backend Debug</button>
                            <button class="template-btn" onclick="loadTemplate('error-analysis')">🔍 Error Analysis</button>
                            <button class="template-btn" onclick="loadTemplate('performance')">⚡ Performance Check</button>
                            <button class="template-btn" onclick="loadTemplate('system-health')">🏥 System Health</button>
                            <button class="template-btn" onclick="loadTemplate('emergency-stop')">🚨 Emergency Stop</button>
                        </div>
                    </div>

                    <!-- DEVELOPMENT -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('dev')">
                            <span>⚙️ DEVELOPMENT</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="dev-templates">
                            <button class="template-btn" onclick="loadTemplate('feature-dev')">✨ Feature Development</button>
                            <button class="template-btn" onclick="loadTemplate('bug-fix')">🔧 Bug Fix</button>
                            <button class="template-btn" onclick="loadTemplate('refactor')">🔄 Refactoring</button>
                            <button class="template-btn" onclick="loadTemplate('code-review')">👀 Code Review</button>
                            <button class="template-btn" onclick="loadTemplate('testing')">🧪 Testing Strategy</button>
                            <button class="template-btn" onclick="loadTemplate('api-dev')">🌐 API Development</button>
                        </div>
                    </div>

                    <!-- SECURITY & COMPLIANCE -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('security')">
                            <span>🔒 SECURITY & COMPLIANCE</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="security-templates">
                            <button class="template-btn" onclick="loadTemplate('security-audit')">🔍 Security Audit</button>
                            <button class="template-btn" onclick="loadTemplate('security-hardening')">🛡️ Security Hardening</button>
                            <button class="template-btn" onclick="loadTemplate('compliance-check')">📋 Compliance Check</button>
                            <button class="template-btn" onclick="loadTemplate('vulnerability-scan')">🔍 Vulnerability Scan</button>
                        </div>
                    </div>

                    <!-- COLLABORATION -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('collab')">
                            <span>👥 COLLABORATION</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="collab-templates">
                            <button class="template-btn" onclick="loadTemplate('team-handoff')">👥 Team Handoff</button>
                            <button class="template-btn" onclick="loadTemplate('client-docs')">📄 Client Documentation</button>
                            <button class="template-btn" onclick="loadTemplate('progress-report')">📊 Progress Report</button>
                            <button class="template-btn" onclick="loadTemplate('issue-escalation')">🚨 Issue Escalation</button>
                            <button class="template-btn" onclick="loadTemplate('requirements-clarification')">❓ Requirements Clarification</button>
                        </div>
                    </div>

                    <!-- CUSTOM TEMPLATES -->
                    <div class="template-category">
                        <div class="category-header" onclick="toggleCategory('custom')">
                            <span>⭐ CUSTOM TEMPLATES</span>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content" id="custom-templates">
                            <div id="custom-template-list">
                                <!-- Custom templates will be loaded here -->
                            </div>
                            <button class="template-btn btn-primary" onclick="createCustomTemplate()">➕ Create New Template</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">📜 AI-Assisted Development Agreement</div>
                <div class="button-group" style="grid-template-columns: repeat(2, 1fr); margin-bottom: 16px;">
                    <button class="btn btn-secondary" onclick="toggleAgreement()">
                        📜 View Full Agreement
                    </button>
                    <button class="btn btn-primary" onclick="showAgreementInjection()">
                        🚀 Inject Agreement
                    </button>
                </div>
                
                <div id="agreement-injection" style="display: none; margin-bottom: 16px;">
                    <div class="section-title" style="font-size: 16px; margin-bottom: 12px;">Select AI Environment</div>
                    
                    <div style="margin-bottom: 12px;">
                        <h6 style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">🎯 Popular AI Assistants</h6>
                        <div class="ai-environment-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 8px;">
                            <button class="ai-env-btn" data-env="claude" onclick="injectAgreement('claude')">
                                🧠 Claude
                            </button>
                            <button class="ai-env-btn" data-env="chatgpt" onclick="injectAgreement('chatgpt')">
                                🤖 ChatGPT
                            </button>
                            <button class="ai-env-btn" data-env="gemini" onclick="injectAgreement('gemini')">
                                💎 Gemini
                            </button>
                            <button class="ai-env-btn" data-env="perplexity" onclick="injectAgreement('perplexity')">
                                🔍 Perplexity
                            </button>
                        </div>
                    </div>

                    <div style="margin-bottom: 12px;">
                        <h6 style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">⚡ IDE-Integrated Tools</h6>
                        <div class="ai-environment-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 8px;">
                            <button class="ai-env-btn" data-env="copilot" onclick="injectAgreement('copilot')">
                                🐙 Copilot
                            </button>
                            <button class="ai-env-btn" data-env="cursor" onclick="injectAgreement('cursor')">
                                📝 Cursor
                            </button>
                            <button class="ai-env-btn" data-env="codeium" onclick="injectAgreement('codeium')">
                                🚀 Codeium
                            </button>
                            <button class="ai-env-btn" data-env="tabnine" onclick="injectAgreement('tabnine')">
                                🔮 TabNine
                            </button>
                        </div>
                    </div>

                    <div style="margin-bottom: 12px;">
                        <h6 style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">🛠️ Specialized Coding Tools</h6>
                        <div class="ai-environment-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 8px;">
                            <button class="ai-env-btn" data-env="aider" onclick="injectAgreement('aider')">
                                🔧 Aider
                            </button>
                            <button class="ai-env-btn" data-env="continue" onclick="injectAgreement('continue')">
                                ▶️ Continue
                            </button>
                            <button class="ai-env-btn" data-env="cody" onclick="injectAgreement('cody')">
                                🤖 Cody
                            </button>
                            <button class="ai-env-btn" data-env="windsurf" onclick="injectAgreement('windsurf')">
                                🏄 Windsurf
                            </button>
                        </div>
                    </div>

                    <div style="margin-bottom: 12px;">
                        <h6 style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">🌊 Web-Based Platforms</h6>
                        <div class="ai-environment-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 8px;">
                            <button class="ai-env-btn" data-env="replit" onclick="injectAgreement('replit')">
                                🔄 Replit
                            </button>
                            <button class="ai-env-btn" data-env="bolt" onclick="injectAgreement('bolt')">
                                ⚡ Bolt.new
                            </button>
                            <button class="ai-env-btn" data-env="v0" onclick="injectAgreement('v0')">
                                🎨 v0.dev
                            </button>
                            <button class="ai-env-btn" data-env="codepen" onclick="injectAgreement('codepen')">
                                🖊️ CodePen
                            </button>
                        </div>
                    </div>

                    <div>
                        <h6 style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">🌐 Universal</h6>
                        <div class="ai-environment-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 8px;">
                            <button class="ai-env-btn" data-env="generic" onclick="injectAgreement('generic')">
                                🌐 Generic
                            </button>
                        </div>
                    </div>
                </div>
                <div class="agreement-content" id="agreement-content" style="display: none; margin-top: 16px; padding: 20px; border: 1px solid var(--border-color); border-radius: var(--radius-lg); background: var(--bg-tertiary); font-size: 12px; line-height: 1.4; max-height: 400px; overflow-y: auto;">
                    <h4>AI-Assisted Development Agreements v1.1</h4>
                    <p><strong>Universal Foundation Document for Professional AI-Assisted Development</strong></p>
                    <br>
                    <p><em>🔄 Version 1.1 Update: Aligned with current AI capabilities based on comprehensive analysis.</em></p>
                    <br>
                    
                    <h5>🎯 CORE PRINCIPLES</h5>
                    <p><strong>Mission:</strong> Enable sustainable, professional AI-assisted development for non-developer professionals to build commercial-grade solutions through structured, efficient, and secure development practices across any project and any AI platform.</p>
                    <br>
                    
                    <h5>🔧 AI BEHAVIOR CONSTRAINTS</h5>
                    <p><strong>MUST ATTEMPT:</strong></p>
                    <ul>
                        <li>Request verification when uncertain</li>
                        <li>Seek permission for risky changes</li>
                        <li>Suggest rollback procedures</li>
                        <li>Recommend testing approaches</li>
                        <li>Generate documentation</li>
                        <li>Follow existing patterns</li>
                        <li>Disclose limitations and confidence levels</li>
                        <li>Attempt context management within technical limits</li>
                    </ul>
                    <br>
                    
                    <p><strong>MUST AVOID:</strong></p>
                    <ul>
                        <li>Making unverified assumptions</li>
                        <li>Stating uncertain facts as absolute</li>
                        <li>Suggesting unauthorized changes</li>
                        <li>Scope creep beyond boundaries</li>
                        <li>Poor or temporary solutions</li>
                        <li>Breaking existing functionality</li>
                        <li>Losing critical context unnecessarily</li>
                    </ul>
                    <br>
                    
                    <h5>⚙️ PRACTICAL DECISION FRAMEWORK</h5>
                    <p><strong>Immediate Action (No Approval Required):</strong></p>
                    <ul>
                        <li>QUICK mode tasks (typos, formatting, comments)</li>
                        <li>Documentation updates</li>
                        <li>Minor bug fixes with obvious solutions</li>
                        <li>Requested implementations (user already approved by asking)</li>
                        <li>Template usage and standard operations</li>
                    </ul>
                    
                    <p><strong>Proceed with Notification:</strong></p>
                    <ul>
                        <li>NORMAL mode standard development</li>
                        <li>Feature additions within defined scope</li>
                        <li>UI/UX improvements</li>
                        <li>Performance optimizations</li>
                        <li><strong>Process:</strong> State intention → implement → report results</li>
                        <li><strong>User Control:</strong> Can interrupt with "stop", "wait", "rollback" at any time</li>
                    </ul>
                    
                    <p><strong>Explicit Approval Required (SECURE Mode Only):</strong></p>
                    <ul>
                        <li>Architecture modifications</li>
                        <li>Security-related changes (auth, encryption, permissions)</li>
                        <li>Breaking changes to existing functionality</li>
                        <li>Database schema changes</li>
                        <li>External dependency additions</li>
                        <li><strong>Process:</strong> Complete analysis → wait for explicit "proceed" confirmation</li>
                    </ul>
                    
                    <p><strong>Emergency Controls:</strong></p>
                    <ul>
                        <li>User can say "stop", "wait", "rollback" to immediately halt work</li>
                        <li>Rollback always available via git stash/revert</li>
                        <li>User can request status/progress at any time</li>
                    </ul>
                    <br>
                    
                    <h5>⚡ DEVELOPMENT MODES</h5>
                    <p><strong>QUICK:</strong> Simple, safe changes (typos, minor fixes) - Immediate execution</p>
                    <p><strong>NORMAL:</strong> Standard development work - State intention → implement → report results</p>
                    <p><strong>SECURE:</strong> Complex, risky changes - Complete analysis → explicit approval → full verification</p>
                    <br>
                    
                    <h5>📊 SUCCESS METRICS</h5>
                    <ul>
                        <li>Simple tasks: 90% success rate</li>
                        <li>Complex tasks: 70% success rate</li>
                        <li>Architectural changes: 50% success rate</li>
                        <li>Security compliance: 100% reviewed (human verification required)</li>
                        <li>Documentation: 100% include suggestions (human review required)</li>
                    </ul>
                    <br>
                    
                    <h5>🛠️ PLATFORM COMPATIBILITY</h5>
                    <p>Works with Claude, ChatGPT, GitHub Copilot, and other AI assistants with appropriate adaptations.</p>
                    <br>
                    
                    <h5>✅ AGREEMENT STATUS</h5>
                    <p><strong>Version:</strong> 1.1 (Realistic Capabilities Update)</p>
                    <p><strong>Status:</strong> Active and approved</p>
                    <p><strong>Limitations:</strong> AI acknowledges technical constraints including context limits, execution dependencies, and verification requirements.</p>
                </div>
            </div>
            </div>
        </div>

        <div class="output-panel">
            <div class="output-header">
                <div class="output-title">
                    <span class="status-indicator"></span>
                    Generated Prompt
                    <span style="font-size: 12px; opacity: 0.7; font-weight: normal;">✏️ Editable</span>
                </div>
            </div>
            
            <textarea class="prompt-output" id="prompt-output" placeholder="Your generated prompt will appear here..." spellcheck="false"></textarea>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="generatePrompt()">
                    🚀 Generate
                </button>
                <button class="btn btn-success" onclick="copyToClipboard()">
                    📋 Copy
                </button>
                <button class="btn btn-secondary" onclick="saveTemplate()">
                    💾 Save
                </button>
                <button class="btn btn-secondary" onclick="loadCustomTemplate()">
                    📁 Load
                </button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // Initialize with saved data
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            generatePrompt(); // Generate initial prompt
            restoreTextareaHeight(); // Restore saved height
            
            // Save height when resized with debouncing
            const textarea = document.getElementById('prompt-output');
            let resizeTimeout;
            const resizeObserver = new ResizeObserver(() => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(saveTextareaHeight, 100);
            });
            resizeObserver.observe(textarea);
        });

        function generatePrompt() {
            const projectName = document.getElementById('project-name').value;
            const projectVersion = document.getElementById('project-version').value;
            const techStack = document.getElementById('tech-stack').value;
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const description = document.getElementById('request-description').value || 'No description provided';
            const constraints = document.getElementById('constraints').value;

            let prompt = '';

            // Mode-specific prefix
            if (mode === 'QUICK') {
                prompt += 'QUICK: ';
            } else if (mode === 'SECURE') {
                prompt += 'SECURE: ';
            }

            // Main request
            prompt += description;

            // Add project context if not QUICK mode
            if (mode !== 'QUICK') {
                prompt += '\n\nPROJECT CONTEXT:';
                if (projectName || projectVersion) {
                    const projectInfo = [projectName, projectVersion].filter(Boolean).join(' ');
                    prompt += `\n- Project: ${projectInfo}`;
                }
                if (techStack) {
                    prompt += `\n- Tech Stack: ${techStack}`;
                }
                prompt += `\n- Mode: ${mode}`;
            }

            // Add constraints if provided
            if (constraints.trim()) {
                prompt += '\n\nCONSTRAINTS:';
                prompt += `\n${constraints}`;
            }

            // Add agreement reference
            if (mode === 'SECURE') {
                prompt += '\n\nREQUIRED: Full analysis, explicit approval, complete verification per AI-Assisted Development Agreements v1.1';
            } else if (mode === 'NORMAL') {
                prompt += '\n\nFOLLOW: AI-Assisted Development Agreements v1.1 protocols';
            }

            // Update the output
            const textarea = document.getElementById('prompt-output');
            const currentHeight = textarea.style.height;
            textarea.value = prompt;
            if (currentHeight) {
                textarea.style.height = currentHeight;
            }

            // Save current data
            saveCurrentData();
        }

        function copyToClipboard() {
            const promptTextarea = document.getElementById('prompt-output');
            promptTextarea.select();
            document.execCommand('copy');
            showToast('Prompt copied to clipboard!');
        }

        function saveTemplate() {
            const template = {
                projectName: document.getElementById('project-name').value,
                projectVersion: document.getElementById('project-version').value,
                techStack: document.getElementById('tech-stack').value,
                mode: document.querySelector('input[name="mode"]:checked').value,
                description: document.getElementById('request-description').value,
                constraints: document.getElementById('constraints').value
            };

            const templateName = prompt('Enter a name for this template:');
            if (templateName) {
                const savedTemplates = JSON.parse(localStorage.getItem('promptTemplates') || '{}');
                savedTemplates[templateName] = template;
                localStorage.setItem('promptTemplates', JSON.stringify(savedTemplates));
                showToast(`Template "${templateName}" saved!`);
            }
        }

        function loadTemplate(templateId) {
            // Handle quick templates
            if (templateId) {
                const templates = {
                    // PROJECT LIFECYCLE
                    'project-init': {
                        description: 'Initialize new project: setup directory structure, create foundational files, establish development environment, and configure initial settings',
                        constraints: 'Ensure proper project organization and follow industry best practices'
                    },
                    'project-continue': {
                        description: 'Continue existing project work: review current state, understand codebase structure, and proceed with development tasks',
                        constraints: 'Maintain existing patterns and conventions'
                    },
                    'project-status': {
                        description: 'Generate comprehensive project status report: analyze progress, identify blockers, assess code quality, and provide next steps recommendations',
                        constraints: 'Focus on actionable insights and specific metrics'
                    },
                    'project-phase': {
                        description: 'Complete current project phase: finalize features, run comprehensive tests, document changes, and prepare for next phase',
                        constraints: 'Ensure all deliverables meet quality standards'
                    },
                    'project-close': {
                        description: 'Close project properly: create final documentation, archive working files, backup critical data, and prepare handoff materials',
                        constraints: 'Ensure complete knowledge transfer and future maintainability'
                    },
                    'daily-start': {
                        description: 'Begin daily development session: review yesterday\'s work, check system status, prioritize today\'s tasks, and establish working environment',
                        constraints: 'Quick startup without major changes'
                    },
                    'daily-end': {
                        description: 'End daily development session: summarize accomplishments, commit changes, backup work, and prepare tomorrow\'s priorities',
                        constraints: 'Ensure all work is properly saved and documented'
                    },

                    // SESSION MANAGEMENT
                    'session-start': {
                        description: 'Load session context from SESSION_NOTES.md, ACTIVATE AGREEMENT: AI-Assisted Development Agreements v1.1, READY: Continue work under agreed protocols',
                        constraints: 'Verify all context restored correctly'
                    },
                    'pre-compact': {
                        description: 'COMPACT: Preserve all decisions, current state, rollback points, and next priorities in SESSION_NOTES.md before compaction',
                        constraints: 'Maintain all critical context for session restoration'
                    },
                    'post-compact': {
                        description: 'Restore session from SESSION_NOTES.md and continue work from last checkpoint',
                        constraints: 'Verify all context restored correctly'
                    },
                    'context-recovery': {
                        description: 'Recover lost context: analyze available files, reconstruct project state, identify last known good checkpoint, and restore working environment',
                        constraints: 'Use only verified information from files and git history'
                    },
                    'handoff': {
                        description: 'Prepare comprehensive handoff: document current state, list active tasks, explain decision rationale, and provide clear next steps',
                        constraints: 'Ensure complete knowledge transfer'
                    },

                    // GIT & BACKUP
                    'git-init': {
                        description: 'Initialize git repository: create .gitignore, setup initial commit, configure remote origin, and establish branching strategy',
                        constraints: 'Follow git best practices and exclude sensitive files'
                    },
                    'git-sync': {
                        description: 'Synchronize with remote repository: pull latest changes, resolve conflicts, push local commits, and verify sync status',
                        constraints: 'Handle conflicts carefully and preserve all changes'
                    },
                    'backup-create': {
                        description: 'Create comprehensive backup: archive project files, export database if applicable, document backup location, and verify backup integrity',
                        constraints: 'Include all critical files and configuration'
                    },
                    'rollback': {
                        description: 'Execute rollback to previous stable state: identify rollback point, restore files from backup/git, verify system functionality, and document rollback reason',
                        constraints: 'Ensure complete restoration without data loss'
                    },
                    'backup-restore': {
                        description: 'Restore from backup: locate backup files, verify integrity, restore to target location, and validate restoration success',
                        constraints: 'Ensure complete and accurate restoration'
                    },
                    'git-recovery': {
                        description: 'EMERGENCY: Recover from git repository corruption or accidental deletion using available backups and git recovery tools',
                        constraints: 'Prioritize data recovery over speed'
                    },

                    // DEBUG & ANALYSIS
                    'frontend-debug': {
                        description: 'Debug frontend issues: analyze console errors, check broken references, validate dependencies, and fix UI/UX problems',
                        constraints: 'Test all changes in multiple browsers'
                    },
                    'backend-debug': {
                        description: 'Debug backend issues: analyze server logs, check API endpoints, validate database connections, and resolve service errors',
                        constraints: 'Ensure no breaking changes to existing functionality'
                    },
                    'error-analysis': {
                        description: 'Analyze critical errors: reproduce issue, trace root cause, assess impact scope, and develop comprehensive fix strategy',
                        constraints: 'Prioritize system stability over feature additions'
                    },
                    'performance': {
                        description: 'Analyze and optimize performance: profile bottlenecks, measure response times, optimize database queries, and improve resource usage',
                        constraints: 'Maintain functionality while improving performance'
                    },
                    'system-health': {
                        description: 'Comprehensive system health check: validate all services, check resource usage, verify database integrity, and assess security status',
                        constraints: 'Non-invasive checks only, no system modifications'
                    },
                    'emergency-stop': {
                        description: 'EMERGENCY: Immediately halt current operations, save all work, create emergency backup, and assess system state for recovery',
                        constraints: 'Prioritize data preservation over completing current task'
                    },

                    // DEVELOPMENT
                    'feature-dev': {
                        description: 'Develop new feature: analyze requirements, design implementation, write code, create tests, and integrate with existing system',
                        constraints: 'Follow existing architecture patterns and coding standards'
                    },
                    'bug-fix': {
                        description: 'Fix identified bug: reproduce issue, analyze root cause, implement fix, test thoroughly, and verify no regressions',
                        constraints: 'Minimal changes to fix specific issue only'
                    },
                    'refactor': {
                        description: 'Refactor code: improve structure, reduce complexity, enhance readability, and maintain existing functionality',
                        constraints: 'Preserve all existing functionality and behavior'
                    },
                    'code-review': {
                        description: 'Conduct comprehensive code review: analyze structure, check for bugs, verify standards compliance, and suggest improvements',
                        constraints: 'Focus on constructive feedback and actionable recommendations'
                    },
                    'testing': {
                        description: 'Develop testing strategy: create unit tests, integration tests, and end-to-end tests to ensure code quality and reliability',
                        constraints: 'Achieve comprehensive coverage of critical functionality'
                    },
                    'api-dev': {
                        description: 'Develop API endpoints: design RESTful interfaces, implement business logic, add proper validation, and create documentation',
                        constraints: 'Follow REST principles and include proper error handling'
                    },

                    // SECURITY & COMPLIANCE
                    'security-audit': {
                        description: 'Conduct security audit: analyze authentication, check for vulnerabilities, review access controls, and assess data protection',
                        constraints: 'Complete analysis required before any security changes'
                    },
                    'security-hardening': {
                        description: 'Implement security hardening: strengthen authentication, encrypt sensitive data, secure API endpoints, and update security policies',
                        constraints: 'Test all security changes thoroughly'
                    },
                    'compliance-check': {
                        description: 'Verify regulatory compliance: check data handling, validate privacy controls, ensure audit trails, and document compliance status',
                        constraints: 'Must maintain compliance during any changes'
                    },
                    'vulnerability-scan': {
                        description: 'Scan for security vulnerabilities: check dependencies, analyze code for security flaws, and assess system configuration',
                        constraints: 'Read-only analysis, no system modifications'
                    },

                    // COLLABORATION
                    'team-handoff': {
                        description: 'Prepare team handoff: document current progress, explain technical decisions, list pending tasks, and provide context for continuation',
                        constraints: 'Ensure complete knowledge transfer'
                    },
                    'client-docs': {
                        description: 'Create client documentation: explain functionality, provide user guides, document API usage, and create troubleshooting guides',
                        constraints: 'Use non-technical language appropriate for client audience'
                    },
                    'progress-report': {
                        description: 'Generate progress report: summarize completed work, highlight achievements, identify challenges, and outline next steps',
                        constraints: 'Include specific metrics and concrete examples'
                    },
                    'issue-escalation': {
                        description: 'Escalate critical issue: document problem details, assess impact, gather supporting evidence, and prepare escalation report',
                        constraints: 'Include all relevant technical details and context'
                    },
                    'requirements-clarification': {
                        description: 'Clarify project requirements: analyze ambiguous specifications, identify missing information, and prepare clarification questions',
                        constraints: 'Focus on specific, actionable questions'
                    }
                };

                if (templates[templateId]) {
                    const template = templates[templateId];
                    // Don't force mode - let user choose based on risk level
                    document.getElementById('request-description').value = template.description;
                    document.getElementById('constraints').value = template.constraints;
                    generatePrompt();
                    showToast(`Template "${templateId}" loaded!`);
                }
                return;
            }

        }

        function loadCustomTemplate() {
            // Handle saved custom templates
            const savedTemplates = JSON.parse(localStorage.getItem('promptTemplates') || '{}');
            const templateNames = Object.keys(savedTemplates);
            
            if (templateNames.length === 0) {
                showToast('No saved templates found.');
                return;
            }

            const templateName = prompt(`Choose a template:\n${templateNames.join('\n')}`);
            if (templateName && savedTemplates[templateName]) {
                const template = savedTemplates[templateName];
                
                document.getElementById('project-name').value = template.projectName || '';
                document.getElementById('project-version').value = template.projectVersion || '';
                document.getElementById('tech-stack').value = template.techStack || '';
                document.querySelector(`input[name="mode"][value="${template.mode}"]`).checked = true;
                document.getElementById('request-description').value = template.description || '';
                document.getElementById('constraints').value = template.constraints || '';
                
                generatePrompt();
                showToast(`Template "${templateName}" loaded!`);
            }
        }

        function toggleAgreement() {
            const content = document.getElementById('agreement-content');
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
            } else {
                content.style.display = 'none';
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.display = 'block';
            setTimeout(function() {
                toast.style.display = 'none';
            }, 3000);
        }

        // Save and restore textarea height
        function saveTextareaHeight() {
            const textarea = document.getElementById('prompt-output');
            localStorage.setItem('promptTextareaHeight', textarea.style.height || '200px');
        }

        function restoreTextareaHeight() {
            const textarea = document.getElementById('prompt-output');
            const savedHeight = localStorage.getItem('promptTextareaHeight');
            if (savedHeight) {
                textarea.style.height = savedHeight;
            }
        }

        function saveCurrentData() {
            const currentData = {
                projectName: document.getElementById('project-name').value,
                projectVersion: document.getElementById('project-version').value,
                techStack: document.getElementById('tech-stack').value
            };
            localStorage.setItem('promptBuilderData', JSON.stringify(currentData));
        }

        function loadSavedData() {
            const savedData = JSON.parse(localStorage.getItem('promptBuilderData') || '{}');
            if (savedData.projectName) document.getElementById('project-name').value = savedData.projectName;
            if (savedData.projectVersion) document.getElementById('project-version').value = savedData.projectVersion;
            if (savedData.techStack) document.getElementById('tech-stack').value = savedData.techStack;
        }

        // Template system functionality
        function toggleCategory(categoryId) {
            const content = document.getElementById(categoryId + '-templates');
            const icon = content.parentElement.querySelector('.toggle-icon');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                icon.classList.remove('rotated');
            } else {
                content.classList.add('open');
                icon.classList.add('rotated');
            }
        }

        function toggleFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favoriteTemplates') || '[]');
            const allButtons = document.querySelectorAll('.template-btn');
            
            if (document.querySelector('.template-btn.favorite')) {
                // Hide favorites view
                allButtons.forEach(btn => {
                    btn.style.display = '';
                    btn.classList.remove('favorite');
                });
            } else {
                // Show only favorites
                allButtons.forEach(btn => {
                    const templateId = btn.getAttribute('onclick').match(/'([^']+)'/)[1];
                    if (favorites.includes(templateId)) {
                        btn.style.display = '';
                        btn.classList.add('favorite');
                    } else {
                        btn.style.display = 'none';
                    }
                });
            }
        }

        function createCustomTemplate() {
            const name = prompt('Template name:');
            if (!name) return;
            
            const description = prompt('Template description:');
            if (!description) return;
            
            const constraints = prompt('Template constraints (optional):') || '';
            
            const customTemplates = JSON.parse(localStorage.getItem('customTemplates') || '{}');
            customTemplates[name] = { description, constraints };
            localStorage.setItem('customTemplates', JSON.stringify(customTemplates));
            
            loadCustomTemplates();
            showToast(`Custom template "${name}" created!`);
        }

        function loadCustomTemplates() {
            const customTemplates = JSON.parse(localStorage.getItem('customTemplates') || '{}');
            const container = document.getElementById('custom-template-list');
            
            container.innerHTML = '';
            Object.keys(customTemplates).forEach(name => {
                const btn = document.createElement('button');
                btn.className = 'template-btn';
                btn.textContent = `📝 ${name}`;
                btn.onclick = () => {
                    const template = customTemplates[name];
                    document.getElementById('request-description').value = template.description;
                    document.getElementById('constraints').value = template.constraints;
                    generatePrompt();
                    showToast(`Custom template "${name}" loaded!`);
                };
                container.appendChild(btn);
            });
        }

        // Search functionality
        document.getElementById('template-search').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const allButtons = document.querySelectorAll('.template-btn');
            
            allButtons.forEach(btn => {
                const text = btn.textContent.toLowerCase();
                if (text.includes(searchTerm) || searchTerm === '') {
                    btn.style.display = '';
                } else {
                    btn.style.display = 'none';
                }
            });
        });

        // Initialize template system
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();
            loadCustomTemplates();
            generatePrompt();
            
            // Open first category by default
            toggleCategory('project');
        });

        // Theme management
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = body.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('theme-icon');
            
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '☀️';
            } else {
                themeIcon.textContent = '🌙';
            }
        }

        // Initialize template system
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            loadSavedData();
            loadCustomTemplates();
            generatePrompt();
            initializeResize();
            setupAutoGeneration();
            
            // Open first category by default
            toggleCategory('project');
        });

        // Horizontal resize functionality
        function initializeResize() {
            const resizeHandle = document.getElementById('resize-handle');
            const appContainer = document.querySelector('.app-container');
            let isResizing = false;

            resizeHandle.addEventListener('mousedown', (e) => {
                isResizing = true;
                resizeHandle.classList.add('dragging');
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';
            });

            document.addEventListener('mousemove', (e) => {
                if (!isResizing) return;

                const containerRect = appContainer.getBoundingClientRect();
                const outputPanelWidth = Math.max(300, Math.min(600, containerRect.right - e.clientX - 24));
                const mainPanelWidth = `calc(100vw - ${outputPanelWidth + 68}px)`;

                appContainer.style.gridTemplateColumns = `${mainPanelWidth} ${outputPanelWidth}px`;
                resizeHandle.style.right = `${outputPanelWidth + 20}px`;

                // Save resize state
                localStorage.setItem('outputPanelWidth', outputPanelWidth);
            });

            document.addEventListener('mouseup', () => {
                if (isResizing) {
                    isResizing = false;
                    resizeHandle.classList.remove('dragging');
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                }
            });

            // Load saved resize state
            const savedWidth = localStorage.getItem('outputPanelWidth');
            if (savedWidth) {
                const outputPanelWidth = parseInt(savedWidth);
                const mainPanelWidth = `calc(100vw - ${outputPanelWidth + 68}px)`;
                appContainer.style.gridTemplateColumns = `${mainPanelWidth} ${outputPanelWidth}px`;
                resizeHandle.style.right = `${outputPanelWidth + 20}px`;
            }
        }

        // Auto-generate prompt when form inputs change (excluding prompt output)
        function setupAutoGeneration() {
            const formInputs = [
                'project-name', 'project-version', 'tech-stack',
                'request-description', 'constraints'
            ];
            
            const modeInputs = document.querySelectorAll('input[name="mode"]');
            
            // Add listeners to form inputs
            formInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', generatePrompt);
                    element.addEventListener('change', generatePrompt);
                }
            });
            
            // Add listeners to mode radio buttons
            modeInputs.forEach(input => {
                input.addEventListener('change', generatePrompt);
            });
        }

        // Agreement injection functionality
        function showAgreementInjection() {
            const injectionDiv = document.getElementById('agreement-injection');
            if (injectionDiv.style.display === 'none') {
                injectionDiv.style.display = 'block';
            } else {
                injectionDiv.style.display = 'none';
            }
        }

        function injectAgreement(aiType) {
            const getProjectInfo = () => {
                const name = document.getElementById('project-name').value;
                const version = document.getElementById('project-version').value;
                const stack = document.getElementById('tech-stack').value;
                return {
                    project: [name, version].filter(Boolean).join(' ') || 'Not specified',
                    techStack: stack || 'Not specified'
                };
            };

            const projectInfo = getProjectInfo();
            const aiHeader = `🤝 AI Assistant: ${aiType.toUpperCase()}
📋 Project: ${projectInfo.project}
⚙️ Tech Stack: ${projectInfo.techStack}

---

`;
            
            const fullAgreement = `

---

## FULL AI-ASSISTED DEVELOPMENT AGREEMENTS v1.1
**Universal Foundation Document for Professional AI-Assisted Development**

### 🎯 CORE PRINCIPLES
**Mission:** Enable sustainable, professional AI-assisted development for non-developer professionals to build commercial-grade solutions through structured, efficient, and secure development practices across any project and any AI platform.

### 🔧 AI BEHAVIOR CONSTRAINTS
**MUST ATTEMPT:**
- Request verification when uncertain
- Seek permission for risky changes
- Suggest rollback procedures
- Recommend testing approaches
- Generate documentation
- Follow existing patterns
- Disclose limitations and confidence levels
- Attempt context management within technical limits

**MUST AVOID:**
- Making unverified assumptions
- Stating uncertain facts as absolute
- Suggesting unauthorized changes
- Scope creep beyond boundaries
- Poor or temporary solutions
- Breaking existing functionality
- Losing critical context unnecessarily

### ⚙️ PRACTICAL DECISION FRAMEWORK
**Immediate Action (No Approval Required):**
- QUICK mode tasks (typos, formatting, comments)
- Documentation updates
- Minor bug fixes with obvious solutions
- Requested implementations (user already approved by asking)
- Template usage and standard operations

**Proceed with Notification:**
- NORMAL mode standard development
- Feature additions within defined scope
- UI/UX improvements
- Performance optimizations
- **Process:** State intention → implement → report results
- **User Control:** Can interrupt with "stop", "wait", "rollback" at any time

**Explicit Approval Required (SECURE Mode Only):**
- Architecture modifications
- Security-related changes (auth, encryption, permissions)
- Breaking changes to existing functionality
- Database schema changes
- External dependency additions
- **Process:** Complete analysis → wait for explicit "proceed" confirmation

**Emergency Controls:**
- User can say "stop", "wait", "rollback" to immediately halt work
- Rollback always available via git stash/revert
- User can request status/progress at any time

### ⚡ DEVELOPMENT MODES
**QUICK:** Simple, safe changes (typos, minor fixes) - Immediate execution
**NORMAL:** Standard development work - State intention → implement → report results
**SECURE:** Complex, risky changes - Complete analysis → explicit approval → full verification

### 📊 SUCCESS METRICS
- Simple tasks: 90% success rate
- Complex tasks: 70% success rate
- Architectural changes: 50% success rate
- Security compliance: 100% reviewed (human verification required)
- Documentation: 100% include suggestions (human review required)

### ✅ AGREEMENT STATUS
**Version:** 1.1 (Realistic Capabilities Update)
**Status:** Active and approved
**Limitations:** AI acknowledges technical constraints including context limits, execution dependencies, and verification requirements.`;

            const agreements = {
                claude: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CLAUDE

ENVIRONMENT: Claude (Anthropic)
- Context: 200K tokens with auto-compaction
- Tools: Available (file operations, code execution, web browsing)
- Strengths: Complex reasoning, code analysis, long conversations
- Limitations: Cannot directly execute code, relies on tools

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Documentation, minor fixes, requested implementations
✅ PROCEED WITH NOTIFICATION: Standard development - state intention → implement → report
🔒 SECURE MODE ONLY: Architecture/security changes require explicit approval

CLAUDE-SPECIFIC ADAPTATIONS:
- Use tools for file operations and code execution
- Leverage conversation memory for context continuity
- Provide detailed analysis before major changes
- Suggest rollback procedures with specific commands
- Handle auto-compaction gracefully with context preservation

PROJECT: ${getProjectInfo().project}
TECH STACK: ${getProjectInfo().techStack}

READY: Proceed under agreed protocols with Claude's capabilities in mind.${fullAgreement}`,

                gemini: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for GEMINI

ENVIRONMENT: Gemini (Google)
- Context: 2M tokens (Gemini 1.5 Pro), conversation continuity
- Tools: Code execution, file analysis, web search, multimodal
- Strengths: Large context, multimodal understanding, Google integration
- Limitations: API rate limits, newer platform with evolving capabilities

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Documentation, minor fixes, requested implementations
✅ PROCEED WITH NOTIFICATION: Standard development - state intention → implement → report
🔒 SECURE MODE ONLY: Architecture/security changes require explicit approval

GEMINI-SPECIFIC ADAPTATIONS:
- Leverage massive context window for full codebase analysis
- Use multimodal capabilities for UI/UX and diagram analysis
- Integrate with Google services when applicable
- Provide comprehensive code reviews with large context
- Handle complex multi-file relationships effectively

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Gemini's large context capabilities.${fullAgreement}`,

                perplexity: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for PERPLEXITY

ENVIRONMENT: Perplexity AI
- Context: Web-augmented AI with real-time search
- Tools: Live web search, up-to-date information, source citations
- Strengths: Current information, research-oriented, source verification
- Limitations: Focused on search/research, limited code execution

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Documentation research, technology updates, best practices
✅ PROCEED WITH NOTIFICATION: Development guidance with current sources
🔒 SECURE MODE ONLY: Architecture decisions require explicit approval

PERPLEXITY-SPECIFIC ADAPTATIONS:
- Research latest technology trends and solutions
- Provide citations for recommended approaches
- Find current documentation and examples
- Verify technology compatibility and versions
- Research security best practices with recent sources

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Perplexity's research capabilities.${fullAgreement}`,

                codeium: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CODEIUM

ENVIRONMENT: Codeium IDE Extension
- Context: File and workspace aware, IDE integrated
- Tools: Code completion, chat, refactoring, code explanations
- Strengths: Fast completions, multi-language support, free tier
- Limitations: IDE-dependent, focused on code assistance

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code completions, refactoring suggestions, bug fixes
✅ PROCEED WITH NOTIFICATION: Feature implementation with IDE context
🔒 SECURE MODE ONLY: Architecture changes require explicit approval

CODEIUM-SPECIFIC ADAPTATIONS:
- Provide intelligent code completions and suggestions
- Use workspace context for relevant recommendations
- Explain complex code sections and patterns
- Suggest refactoring opportunities
- Optimize for speed and accuracy in IDE workflow

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Codeium's IDE integration.`,

                tabnine: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for TABNINE

ENVIRONMENT: TabNine AI Assistant
- Context: Local and cloud models, team learning
- Tools: Code completion, code review, test generation, documentation
- Strengths: Privacy-focused, team customization, enterprise features
- Limitations: Primarily completion-focused, subscription-based features

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code completions, test generation, documentation
✅ PROCEED WITH NOTIFICATION: Code reviews and refactoring suggestions
🔒 SECURE MODE ONLY: Architecture changes require explicit approval

TABNINE-SPECIFIC ADAPTATIONS:
- Leverage team-trained models for project-specific suggestions
- Maintain privacy with local processing when configured
- Generate comprehensive test cases
- Provide code review insights
- Optimize for enterprise development workflows

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with TabNine's team-aware capabilities.`,

                aider: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for AIDER

ENVIRONMENT: Aider CLI (Command Line AI Coder)
- Context: Git repository awareness, file-based operations
- Tools: Direct file editing, git integration, terminal commands
- Strengths: Autonomous coding, git workflow integration, repository-wide changes
- Limitations: Command-line interface, requires git repository

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): File edits, git commits, small fixes
✅ PROCEED WITH NOTIFICATION: Multi-file changes with git tracking
🔒 SECURE MODE ONLY: Repository-wide refactoring requires explicit approval

AIDER-SPECIFIC ADAPTATIONS:
- Work directly with git repository structure
- Make atomic commits for each logical change
- Understand repository context and file relationships
- Use git workflow for change tracking and rollbacks
- Provide clear commit messages following project conventions

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Aider's git-integrated workflow.`,

                continue: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CONTINUE

ENVIRONMENT: Continue IDE Extension
- Context: Codebase-aware, VS Code/JetBrains integration
- Tools: Tab completion, chat interface, code actions, refactoring
- Strengths: Open source, customizable, multiple model support
- Limitations: Extension-dependent, requires configuration

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code completions, explanations, quick fixes
✅ PROCEED WITH NOTIFICATION: Refactoring and feature implementation
🔒 SECURE MODE ONLY: Architecture changes require explicit approval

CONTINUE-SPECIFIC ADAPTATIONS:
- Leverage codebase indexing for context-aware suggestions
- Use configured models (OpenAI, Anthropic, local) appropriately
- Provide tab completions and chat assistance
- Integrate with IDE for seamless workflow
- Respect custom configuration and model preferences

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Continue's flexible integration.`,

                cody: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CODY

ENVIRONMENT: Cody by Sourcegraph
- Context: Enterprise codebase understanding, repository indexing
- Tools: Code search, chat, completions, code intelligence
- Strengths: Enterprise-grade, large codebase handling, security-focused
- Limitations: Enterprise features require subscription, complex setup

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code search, documentation, explanations
✅ PROCEED WITH NOTIFICATION: Feature development with enterprise context
🔒 SECURE MODE ONLY: Enterprise architecture changes require explicit approval

CODY-SPECIFIC ADAPTATIONS:
- Utilize enterprise codebase indexing for comprehensive understanding
- Provide security-aware suggestions and reviews
- Leverage Sourcegraph's code intelligence features
- Handle large, complex codebases effectively
- Maintain enterprise compliance and security standards

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Cody's enterprise capabilities.`,

                windsurf: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for WINDSURF

ENVIRONMENT: Windsurf IDE (Codeium)
- Context: Full IDE with AI integration, codebase awareness
- Tools: Integrated AI chat, code editing, project management
- Strengths: Native AI IDE, seamless integration, project understanding
- Limitations: Newer platform, limited ecosystem

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code editing, project navigation, quick fixes
✅ PROCEED WITH NOTIFICATION: Feature development with full IDE context
🔒 SECURE MODE ONLY: Project architecture changes require explicit approval

WINDSURF-SPECIFIC ADAPTATIONS:
- Leverage native AI integration for seamless development
- Use full project context for informed suggestions
- Integrate AI assistance throughout development workflow
- Provide real-time coding assistance and guidance
- Optimize for AI-first development experience

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Windsurf's AI-native environment.`,

                replit: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for REPLIT

ENVIRONMENT: Replit AI (Web-based IDE)
- Context: Cloud-based development, real-time collaboration
- Tools: AI chat, code generation, debugging, deployment
- Strengths: Zero-setup development, collaborative features, integrated hosting
- Limitations: Web-based constraints, internet dependency

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code generation, debugging, explanations
✅ PROCEED WITH NOTIFICATION: Feature development in cloud environment
🔒 SECURE MODE ONLY: Project architecture changes require explicit approval

REPLIT-SPECIFIC ADAPTATIONS:
- Work within cloud-based development constraints
- Leverage collaborative features for team development
- Use integrated deployment for rapid prototyping
- Optimize for web-based development workflow
- Provide real-time assistance and debugging

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Replit's cloud-based capabilities.`,

                bolt: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for BOLT.NEW

ENVIRONMENT: Bolt.new (StackBlitz)
- Context: Web-based development, instant deployment
- Tools: AI-powered project generation, real-time preview, npm integration
- Strengths: Rapid prototyping, instant deployment, framework templates
- Limitations: Web-only projects, limited to frontend/fullstack web apps

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Component generation, styling, quick fixes
✅ PROCEED WITH NOTIFICATION: Feature implementation with instant preview
🔒 SECURE MODE ONLY: Project architecture changes require explicit approval

BOLT-SPECIFIC ADAPTATIONS:
- Generate complete web applications from prompts
- Provide instant preview and deployment capabilities
- Work within web development constraints
- Optimize for rapid iteration and prototyping
- Leverage modern web frameworks and tools

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Bolt's rapid web development.`,

                v0: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for V0.DEV

ENVIRONMENT: v0 by Vercel
- Context: AI-powered UI generation, design-to-code
- Tools: Component generation, styling, React/Next.js focus
- Strengths: High-quality UI components, design-aware, modern frameworks
- Limitations: Primarily UI-focused, React ecosystem specific

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): UI component generation, styling adjustments
✅ PROCEED WITH NOTIFICATION: Interface development with design considerations
🔒 SECURE MODE ONLY: Application architecture changes require explicit approval

V0-SPECIFIC ADAPTATIONS:
- Generate high-quality React/Next.js components
- Focus on modern UI/UX patterns and accessibility
- Provide responsive and well-styled interfaces
- Integrate with Vercel deployment ecosystem
- Optimize for design-to-code workflows

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with v0's UI generation capabilities.`,

                codepen: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CODEPEN

ENVIRONMENT: CodePen (Web-based code editor)
- Context: Frontend-focused, live preview, community sharing
- Tools: HTML/CSS/JS editing, live preview, AI assistance (limited)
- Strengths: Rapid prototyping, frontend experimentation, community features
- Limitations: Frontend only, limited AI integration, sandbox environment

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Frontend code snippets, styling experiments
✅ PROCEED WITH NOTIFICATION: Interactive demo development
🔒 SECURE MODE ONLY: Complex frontend architecture requires explicit approval

CODEPEN-SPECIFIC ADAPTATIONS:
- Focus on frontend technologies (HTML, CSS, JavaScript)
- Provide live preview for immediate feedback
- Create shareable demos and prototypes
- Work within sandbox environment constraints
- Optimize for experimentation and learning

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with CodePen's frontend focus.`,

                chatgpt: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CHATGPT

ENVIRONMENT: ChatGPT (OpenAI)
- Context: 128K tokens (GPT-4) with conversation limits
- Tools: Limited (code interpreter, web browsing, file analysis)
- Strengths: Natural conversation, creative problem solving
- Limitations: Cannot persistently access external files, session-based

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Documentation, minor fixes, requested implementations
✅ PROCEED WITH NOTIFICATION: Standard development - state intention → implement → report
🔒 SECURE MODE ONLY: Architecture/security changes require explicit approval

CHATGPT-SPECIFIC ADAPTATIONS:
- Work with uploaded files and code snippets
- Use code interpreter for testing and validation
- Provide clear, step-by-step instructions for implementation
- Request file contents when needed for analysis
- Suggest verification methods you can perform

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with ChatGPT's interface in mind.${fullAgreement}`,

                copilot: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for GITHUB COPILOT

ENVIRONMENT: GitHub Copilot (Microsoft/OpenAI)
- Context: File/workspace aware, IDE integrated
- Tools: Code completion, chat interface, inline suggestions
- Strengths: Real-time code assistance, context-aware suggestions
- Limitations: Limited to current workspace, no external operations

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code completions, minor fixes, refactoring suggestions
✅ PROCEED WITH NOTIFICATION: Feature implementation - explain approach → code → verify
🔒 SECURE MODE ONLY: Architecture changes require explicit approval

COPILOT-SPECIFIC ADAPTATIONS:
- Leverage workspace context and file awareness
- Provide inline code suggestions and completions
- Use chat for planning and architectural discussions
- Suggest testing approaches within IDE
- Focus on code quality and best practices

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Copilot's IDE integration.${fullAgreement}`,

                cursor: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for CURSOR

ENVIRONMENT: Cursor (Anysphere)
- Context: Full codebase awareness, VS Code based
- Tools: Integrated terminal, file operations, AI-powered editing
- Strengths: Codebase understanding, intelligent suggestions, composer mode
- Limitations: Focused on current project scope

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Code edits, refactoring, bug fixes
✅ PROCEED WITH NOTIFICATION: Feature development - plan → implement → test
🔒 SECURE MODE ONLY: Major architectural changes require explicit approval

CURSOR-SPECIFIC ADAPTATIONS:
- Utilize full codebase context for informed decisions
- Use composer mode for complex multi-file changes
- Leverage terminal integration for testing and execution
- Apply codebase patterns and conventions automatically
- Provide contextual suggestions based on project structure

PROJECT: ${[document.getElementById('project-name').value, document.getElementById('project-version').value].filter(Boolean).join(' ') || 'Not specified'}
TECH STACK: ${document.getElementById('tech-stack').value || 'Not specified'}

READY: Proceed under agreed protocols with Cursor's codebase awareness.`,

                generic: `ACTIVATE AI-ASSISTED DEVELOPMENT AGREEMENT v1.1 for AI ASSISTANT

ENVIRONMENT: Generic AI Assistant
- Context: Variable depending on platform
- Tools: Platform-dependent capabilities
- Strengths: Following structured development protocols
- Limitations: May vary by platform and session

OPERATIONAL MODE: ${document.querySelector('input[name="mode"]:checked').value}

CORE BEHAVIORS:
✅ IMMEDIATE ACTION (No Approval): Documentation, minor fixes, requested implementations
✅ PROCEED WITH NOTIFICATION: Standard development - state intention → implement → report
🔒 SECURE MODE ONLY: Architecture/security changes require explicit approval

UNIVERSAL ADAPTATIONS:
- Request clarification when platform capabilities are unclear
- Provide implementation suggestions within known constraints
- Suggest verification and testing approaches
- Recommend rollback procedures appropriate to environment
- Disclose limitations and request human assistance when needed

PROJECT: ${getProjectInfo().project}
TECH STACK: ${getProjectInfo().techStack}

READY: Proceed under agreed protocols with universal compatibility approach.${fullAgreement}`
            };

            // Set the generated agreement as the prompt output
            let finalAgreement = agreements[aiType];
            
            // Add full agreement to agreements that don't already have it
            if (!finalAgreement.includes('## FULL AI-ASSISTED DEVELOPMENT AGREEMENTS')) {
                finalAgreement += fullAgreement;
            }
            
            document.getElementById('prompt-output').value = aiHeader + finalAgreement;
            
            // Hide the injection interface
            document.getElementById('agreement-injection').style.display = 'none';
            
            // Show success message
            const aiNames = {
                claude: 'Claude', chatgpt: 'ChatGPT', gemini: 'Gemini', perplexity: 'Perplexity',
                copilot: 'GitHub Copilot', cursor: 'Cursor', codeium: 'Codeium', tabnine: 'TabNine',
                aider: 'Aider', continue: 'Continue', cody: 'Cody', windsurf: 'Windsurf',
                replit: 'Replit', bolt: 'Bolt.new', v0: 'v0.dev', codepen: 'CodePen', generic: 'Generic AI'
            };
            showToast(`Agreement injected for ${aiNames[aiType] || aiType}!`);
        }
    </script>
</body>
</html>